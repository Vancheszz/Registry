# Тестовый контур

В корне проекта создан каталог `tests` с тремя подпапками:
- `нагрузочные/` — сценарии Locust для массового входа и записи на приём.
- `unit/` — pytest-юнит-тесты, проверяющие запросы к backend FastAPI.
- `ручное тестирование/` — материалы для ручной проверки через Selenium (Chrome).

Все комментарии и описания оставлены на русском языке.

## Быстрый обзор файлов
- `нагрузочные/locustfile.py` — Locust-пользователь, моделирующий до 100 одновременных сессий: логины, массовые записи и фиксацию заметок в журнале передач смен.
- `unit/conftest.py` — фикстуры pytest: временная SQLite-база, тестовые пользователи и подмена зависимостей FastAPI.
- `unit/test_*.py` — набор юнит-тестов для аутентификации, пользователей, пациентов, смен и утилит.
- `ручное тестирование/selenium_manual.md` — инструкция по ручному запуску сценария Selenium.
- `ручное тестирование/selenium_login_and_booking.py` — скрипт для автоматического входа и создания записи в UI.

## Как запускать тесты
### Unit (pytest)
1. Установите зависимости: `pip install -r backend/requirements.txt`.
2. Запустите: `pytest tests/unit -q`. База данных создаётся и очищается автоматически перед каждым тестом.

### Нагрузочное тестирование (Locust)
1. Установите зависимости: `pip install -r backend/requirements.txt` (включает `locust`).
2. Запустите приложение (backend) на `http://localhost:8000` или задайте `--host` при старте.
3. Выполните команду с требуемой нагрузкой (до 100 пользователей одновременно):
   ```bash
   locust -f tests/нагрузочные/locustfile.py --users 100 --spawn-rate 10 --host http://localhost:8000
   ```
4. В веб-интерфейсе Locust контролируйте прогресс сценариев «массовый вход», «массовая запись на приём» и «запись наблюдения в журнал».

### Ручное тестирование (Selenium, Chrome)
Подробности — в `tests/ручное тестирование/selenium_manual.md`. Кратко:
1. Установите Chrome WebDriver и экспортируйте путь: `export CHROMEDRIVER=/path/to/chromedriver`.
2. Запустите фронтенд и бэкенд локально.
3. Выполните:
   ```bash
   python "tests/ручное тестирование/selenium_login_and_booking.py"
   ```
   Скрипт откроет Chrome, выполнит вход и создаст запись на ближайшую дату.
